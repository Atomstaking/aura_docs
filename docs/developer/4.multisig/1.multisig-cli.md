---
sidebar_position: 0
sidebar_label: Using CLI
---

# Multisig

A **multisig account** is an Aura account with a special key that can require more than one signature to sign transactions. This can be useful for increasing the security of the account or for requiring the consent of multiple parties to make transactions. Multisig accounts can be created by specifying:

- threshold number of signatures required
- the public keys involved in signing

To sign with a multisig account, the transaction must be signed individually by the different keys specified for the account. Then, the signatures will be combined into a multi-signature which can be used to sign the transaction. If fewer than the threshold number of signatures needed are present, the resultant multi-signature is considered invalid.

# Generate a Multisig key

```
aurad keys add --multisig=name1,name2,name3[...] --multisig-threshold=K new_key_name
```

`K` is the minimum number of private keys that must have signed the transactions that carry the public key's address as signer.

The `--multisig` flag must contain the name of public keys that will be combined into a public key that will be generated and stored as `new_key_name` in the local database. All names supplied through `--multisig` must already exist in the local database.

Unless the flag `--nosort` is set, the order in which the keys are supplied on the command line does not matter, i.e. the following commands generate two identical keys:

```
aurad keys add --multisig=p1,p2,p3 --multisig-threshold=2 multisig_address
aurad keys add --multisig=p2,p3,p1 --multisig-threshold=2 multisig_address
```

# Signing a transaction

## Step 1: Create the multisig key

Let's assume that you have `test1` and `test2` want to make a multisig account with `test3`.

First import the public keys of `test3` into your keyring.

```
aurad keys add \
    test3 \
    --pubkey='{"@type":"/cosmos.crypto.secp256k1.PubKey","key":"Arow5Hb8CbBYKWjuWIM5KWoEvbwCUmNti+2Kdaqrjd/T"}'
```

Generate the multisig key with 2/3 threshold.

```
aurad keys add \
    multi \
    --multisig=test1,test2,test3 \
    --multisig-threshold=2
```

You can see its address and details:

```
aurad keys show multi

- name: multi
  type: multi
  address: aura1tk736vetmgplrefcak0l62gak8h28m9ccqynxj
  pubkey: '{"@type":"/cosmos.crypto.multisig.LegacyAminoPubKey","threshold":2,"public_keys":[{"@type":"/cosmos.crypto.secp256k1.PubKey","key":"Arow5Hb8CbBYKWjuWIM5KWoEvbwCUmNti+2Kdaqrjd/T"},{"@type":"/cosmos.crypto.secp256k1.PubKey","key":"Asc2LPPqgjWTuKvGZMKrhLXUxFjyLRtxy4mBtxqw3RG2"},{"@type":"/cosmos.crypto.secp256k1.PubKey","key":"AmFtbMlegjibAduEBfNyZcVjrIN3W8JzGu/eIGzBUDVI"}]}'
  mnemonic: ""
```

Let's add 2 AURA to the multisig wallet:

```
aurad tx bank send \
    test1 \
    aura1tk736vetmgplrefcak0l62gak8h28m9ccqynxj \
    2000000uaura \
    --chain-id=xstaxy-1 \
    --gas=auto \
    --fees=100000uaura \
    --node https://rpc.aura.network:443
```

Query balance:

```
aurad query bank balances --chain-id xstaxy-1 --node https://rpc.aura.network:443 aura1tk736vetmgplrefcak0l62gak8h28m9ccqynxj
balances:
- amount: "2000000"
  denom: uaura
pagination:
  next_key: null
  total: "0"
```

## Step 2: Create the multisig transaction

We want to send 1 AURA from our multisig account to `aura1hctj3tpmucmuv02umf9252enjedkce7mml69k8`.

```
aurad tx bank send \
    aura1tk736vetmgplrefcak0l62gak8h28m9ccqynxj \
    aura1hctj3tpmucmuv02umf9252enjedkce7mml69k8 \
    1000000uaura \
    --gas=200000 \
    --fees 100000uaura \
    --chain-id xstaxy-1 \
    --generate-only > unsignedTx.json
```

The file `unsignedTx.json` contains the unsigned transaction encoded in JSON.

```JSON
{
  "body": {
    "messages": [
      {
        "@type": "/cosmos.bank.v1beta1.MsgSend",
        "from_address": "aura1tk736vetmgplrefcak0l62gak8h28m9ccqynxj",
        "to_address": "aura1hctj3tpmucmuv02umf9252enjedkce7mml69k8",
        "amount": [
          {
            "denom": "uaura",
            "amount": "1000000"
          }
        ]
      }
    ],
    "memo": "",
    "timeout_height": "0",
    "extension_options": [],
    "non_critical_extension_options": []
  },
  "auth_info": {
    "signer_infos": [],
    "fee": {
      "amount": [
        {
          "denom": "uaura",
          "amount": "100000"
        }
      ],
      "gas_limit": "200000",
      "payer": "",
      "granter": ""
    }
  },
  "signatures": []
}
```

## Step 3: Sign individually

Sign with `test1` and `test2` and create individual signatures.

```
aurad tx sign --from test1 --multisig aura1tk736vetmgplrefcak0l62gak8h28m9ccqynxj unsignedTx.json --sign-mode amino-json --chain-id xstaxy-1 --node https://rpc.aura.network:443 --output-document=tx-signed-test1.json >> tx-signed-test1.json


aurad tx sign \
    unsignedTx.json \
    --from test1 \
    --multisig aura1tk736vetmgplrefcak0l62gak8h28m9ccqynxj \
    --sign-mode amino-json \
    --chain-id xstaxy-1 \
    --node https://rpc.aura.network:443 \
    --output-document=tx-signed-test1.json

aurad tx sign \
    unsignedTx.json \
    --multisig aura1tk736vetmgplrefcak0l62gak8h28m9ccqynxj \
    --from test2 \
    --sign-mode amino-json \
    --chain-id xstaxy-1 \
    --node https://rpc.aura.network:443 \
    --output-document=tx-signed-test2.json
```

## Step 4: Create multisignature

Combine signatures to sign transaction.

```
aurad tx multisign \
    unsignedTx.json \
    multi \
    tx-signed-test1.json tx-signed-test2.json \
    --chain-id xstaxy-1 \
    --node https://rpc.aura.network:443 > signedTx.json
```

The TX is now signed:

```JSON
{
  "body": {
    "messages": [
      {
        "@type": "/cosmos.bank.v1beta1.MsgSend",
        "from_address": "aura1tk736vetmgplrefcak0l62gak8h28m9ccqynxj",
        "to_address": "aura1hctj3tpmucmuv02umf9252enjedkce7mml69k8",
        "amount": [
          {
            "denom": "uaura",
            "amount": "1000000"
          }
        ]
      }
    ],
    "memo": "",
    "timeout_height": "0",
    "extension_options": [],
    "non_critical_extension_options": []
  },
  "auth_info": {
    "signer_infos": [
      {
        "public_key": {
          "@type": "/cosmos.crypto.multisig.LegacyAminoPubKey",
          "threshold": 2,
          "public_keys": [
            {
              "@type": "/cosmos.crypto.secp256k1.PubKey",
              "key": "Arow5Hb8CbBYKWjuWIM5KWoEvbwCUmNti+2Kdaqrjd/T"
            },
            {
              "@type": "/cosmos.crypto.secp256k1.PubKey",
              "key": "Asc2LPPqgjWTuKvGZMKrhLXUxFjyLRtxy4mBtxqw3RG2"
            },
            {
              "@type": "/cosmos.crypto.secp256k1.PubKey",
              "key": "AmFtbMlegjibAduEBfNyZcVjrIN3W8JzGu/eIGzBUDVI"
            }
          ]
        },
        "mode_info": {
          "multi": {
            "bitarray": {
              "extra_bits_stored": 3,
              "elems": "YA=="
            },
            "mode_infos": [
              {
                "single": {
                  "mode": "SIGN_MODE_LEGACY_AMINO_JSON"
                }
              },
              {
                "single": {
                  "mode": "SIGN_MODE_LEGACY_AMINO_JSON"
                }
              }
            ]
          }
        },
        "sequence": "0"
      }
    ],
    "fee": {
      "amount": [
        {
          "denom": "uaura",
          "amount": "100000"
        }
      ],
      "gas_limit": "200000",
      "payer": "",
      "granter": ""
    }
  },
  "signatures": [
    "CkDDowe0qGxH+5OE99Xc4dSuD+SeSXoN5sZTEwGG2pBUripo6ri5XrtcSeigkcqmCY+0anBFcmFAFnmVrYxt9v1KCkDAjWX1Xsik1F62RZJ0o62+7BdfRUIO0THOfKihP0gx11mBxdEd3DGi1ZwU4pgNznibawrmpiPaaTYvBQjbPC7l"
  ]
```

## Step 5: Broadcast transaction

```
aurad tx broadcast \
    signedTx.json \
    --chain-id xstaxy-1 \
    --node https://rpc.aura.network:443
```

Output:

```yaml
code: 0
codespace: ''
data: 0A1E0A1C2F636F736D6F732E62616E6B2E763162657461312E4D736753656E64
events:
  - attributes:
      - index: true
        key: c3BlbmRlcg==
        value: YXVyYTF0azczNnZldG1ncGxyZWZjYWswbDYyZ2FrOGgyOG05Y2NxeW54ag==
      - index: true
        key: YW1vdW50
        value: MTAwMDAwdWF1cmE=
    type: coin_spent
  - attributes:
      - index: true
        key: cmVjZWl2ZXI=
        value: YXVyYTE3eHBmdmFrbTJhbWc5NjJ5bHM2Zjg0ejNrZWxsOGM1bHQwNXpmeQ==
      - index: true
        key: YW1vdW50
        value: MTAwMDAwdWF1cmE=
    type: coin_received
  - attributes:
      - index: true
        key: cmVjaXBpZW50
        value: YXVyYTE3eHBmdmFrbTJhbWc5NjJ5bHM2Zjg0ejNrZWxsOGM1bHQwNXpmeQ==
      - index: true
        key: c2VuZGVy
        value: YXVyYTF0azczNnZldG1ncGxyZWZjYWswbDYyZ2FrOGgyOG05Y2NxeW54ag==
      - index: true
        key: YW1vdW50
        value: MTAwMDAwdWF1cmE=
    type: transfer
  - attributes:
      - index: true
        key: c2VuZGVy
        value: YXVyYTF0azczNnZldG1ncGxyZWZjYWswbDYyZ2FrOGgyOG05Y2NxeW54ag==
    type: message
  - attributes:
      - index: true
        key: ZmVl
        value: MTAwMDAwdWF1cmE=
      - index: true
        key: ZmVlX3BheWVy
        value: YXVyYTF0azczNnZldG1ncGxyZWZjYWswbDYyZ2FrOGgyOG05Y2NxeW54ag==
    type: tx
  - attributes:
      - index: true
        key: YWNjX3NlcQ==
        value: YXVyYTF0azczNnZldG1ncGxyZWZjYWswbDYyZ2FrOGgyOG05Y2NxeW54ai8w
    type: tx
  - attributes:
      - index: true
        key: c2lnbmF0dXJl
        value: dzZNSHRLaHNSL3VUaFBmVjNPSFVyZy9rbmtsNkRlYkdVeE1CaHRxUVZLNHFhT3E0dVY2N1hFbm9vSkhLcGdtUHRHcHdSWEpoUUJaNWxhMk1iZmI5U2c9PQ==
    type: tx
  - attributes:
      - index: true
        key: c2lnbmF0dXJl
        value: d0kxbDlWN0lwTlJldGtXU2RLT3R2dXdYWDBWQ0R0RXh6bnlvb1Q5SU1kZFpnY1hSSGR3eG90V2NGT0tZRGM1NG0yc0s1cVlqMm1rMkx3VUkyend1NVE9PQ==
    type: tx
  - attributes:
      - index: true
        key: c2lnbmF0dXJl
        value: Q2tERG93ZTBxR3hIKzVPRTk5WGM0ZFN1RCtTZVNYb041c1pURXdHRzJwQlVyaXBvNnJpNVhydGNTZWlna2NxbUNZKzBhbkJGY21GQUZubVZyWXh0OXYxS0NrREFqV1gxWHNpazFGNjJSWkowbzYyKzdCZGZSVUlPMFRIT2ZLaWhQMGd4MTFtQnhkRWQzREdpMVp3VTRwZ056bmliYXdybXBpUGFhVFl2QlFqYlBDN2w=
    type: tx
  - attributes:
      - index: true
        key: YWN0aW9u
        value: L2Nvc21vcy5iYW5rLnYxYmV0YTEuTXNnU2VuZA==
    type: message
  - attributes:
      - index: true
        key: c3BlbmRlcg==
        value: YXVyYTF0azczNnZldG1ncGxyZWZjYWswbDYyZ2FrOGgyOG05Y2NxeW54ag==
      - index: true
        key: YW1vdW50
        value: MTAwMDAwMHVhdXJh
    type: coin_spent
  - attributes:
      - index: true
        key: cmVjZWl2ZXI=
        value: YXVyYTFoY3RqM3RwbXVjbXV2MDJ1bWY5MjUyZW5qZWRrY2U3bW1sNjlrOA==
      - index: true
        key: YW1vdW50
        value: MTAwMDAwMHVhdXJh
    type: coin_received
  - attributes:
      - index: true
        key: cmVjaXBpZW50
        value: YXVyYTFoY3RqM3RwbXVjbXV2MDJ1bWY5MjUyZW5qZWRrY2U3bW1sNjlrOA==
      - index: true
        key: c2VuZGVy
        value: YXVyYTF0azczNnZldG1ncGxyZWZjYWswbDYyZ2FrOGgyOG05Y2NxeW54ag==
      - index: true
        key: YW1vdW50
        value: MTAwMDAwMHVhdXJh
    type: transfer
  - attributes:
      - index: true
        key: c2VuZGVy
        value: YXVyYTF0azczNnZldG1ncGxyZWZjYWswbDYyZ2FrOGgyOG05Y2NxeW54ag==
    type: message
  - attributes:
      - index: true
        key: bW9kdWxl
        value: YmFuaw==
    type: message
gas_used: '94895'
gas_wanted: '200000'
height: '50782'
info: ''
logs:
  - events:
      - attributes:
          - key: receiver
            value: aura1hctj3tpmucmuv02umf9252enjedkce7mml69k8
          - key: amount
            value: 1000000uaura
        type: coin_received
      - attributes:
          - key: spender
            value: aura1tk736vetmgplrefcak0l62gak8h28m9ccqynxj
          - key: amount
            value: 1000000uaura
        type: coin_spent
      - attributes:
          - key: action
            value: /cosmos.bank.v1beta1.MsgSend
          - key: sender
            value: aura1tk736vetmgplrefcak0l62gak8h28m9ccqynxj
          - key: module
            value: bank
        type: message
      - attributes:
          - key: recipient
            value: aura1hctj3tpmucmuv02umf9252enjedkce7mml69k8
          - key: sender
            value: aura1tk736vetmgplrefcak0l62gak8h28m9ccqynxj
          - key: amount
            value: 1000000uaura
        type: transfer
    log: ''
    msg_index: 0
raw_log: '[{"events":[{"type":"coin_received","attributes":[{"key":"receiver","value":"aura1hctj3tpmucmuv02umf9252enjedkce7mml69k8"},{"key":"amount","value":"1000000uaura"}]},{"type":"coin_spent","attributes":[{"key":"spender","value":"aura1tk736vetmgplrefcak0l62gak8h28m9ccqynxj"},{"key":"amount","value":"1000000uaura"}]},{"type":"message","attributes":[{"key":"action","value":"/cosmos.bank.v1beta1.MsgSend"},{"key":"sender","value":"aura1tk736vetmgplrefcak0l62gak8h28m9ccqynxj"},{"key":"module","value":"bank"}]},{"type":"transfer","attributes":[{"key":"recipient","value":"aura1hctj3tpmucmuv02umf9252enjedkce7mml69k8"},{"key":"sender","value":"aura1tk736vetmgplrefcak0l62gak8h28m9ccqynxj"},{"key":"amount","value":"1000000uaura"}]}]}]'
timestamp: ''
tx: null
txhash: E8409BEB38E2367A182AF62AD1D2AA930DEABD710A57CD6C616BA46D825620DA
```
